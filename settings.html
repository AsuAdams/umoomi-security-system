<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Settings â€“ Umoomi Security System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ICONS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:"Segoe UI",sans-serif;background:#f2f2f2;padding:20px}
.container{max-width:1400px;margin:auto}

/* HEADER */
header{
  background:#ccdc;padding:20px;border-radius:10px;
  display:flex;align-items:center;gap:15px;
  box-shadow:0 4px 6px rgba(0,0,0,.1);
  margin-bottom:20px
}
header i{font-size:2.5rem;color:#2c3e50}

/* LAYOUT */
.layout{display:grid;grid-template-columns:240px 1fr;gap:20px}

/* SIDEBAR */
aside{
  background:#fff;border-radius:10px;padding:15px;
  box-shadow:0 4px 6px rgba(0,0,0,.1);
  height:calc(100vh - 160px)
}
aside a{
  display:block;text-decoration:none;
  padding:12px 15px;border-radius:6px;
  color:#2c3e50;margin-bottom:6px;font-size:1rem
}
aside a i{width:22px;margin-right:10px}
aside a.active,aside a:hover{
  background:#3498db;color:#fff
}

/* MAIN */
main{
  background:#fff;border-radius:10px;padding:20px;
  box-shadow:0 4px 6px rgba(0,0,0,.1);
  height:calc(100vh - 160px);
  overflow:auto
}

/* SETTINGS */
.setting-group{margin-bottom:25px}
.setting-group h3{margin-bottom:10px;color:#2c3e50}

.setting{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 0;
  border-bottom:1px solid #eee
}
.setting input[type="text"]{
  padding:8px;
  border-radius:6px;
  border:2px solid #ddd;
  width:320px
}

/* TOGGLE */
.toggle{
  width:50px;
  height:26px;
  background:#ccc;
  border-radius:20px;
  position:relative;
  cursor:pointer
}
.toggle::after{
  content:"";
  width:22px;
  height:22px;
  background:#fff;
  border-radius:50%;
  position:absolute;
  top:2px;
  left:2px;
  transition:.2s
}
.toggle.active{background:#2ecc71}
.toggle.active::after{left:26px}

.save-btn{
  background:#3498db;
  color:#fff;
  border:none;
  padding:10px 18px;
  border-radius:6px;
  cursor:pointer;
  font-size:1rem
}
</style>
</head>

<body>
<div class="container">

<header>
  <i class="fas fa-cog"></i>
  <div>
    <h2>System Settings</h2>
    <small>Umoomi Security System</small>
  </div>
</header>

<div class="layout">

<!-- SIDEBAR -->
<aside>
  <a href="index.html" class="nav-link"><i class="fas fa-users"></i> Dashboard</a>
  <a href="members.html" class="nav-link"><i class="fas fa-users"></i> Members</a>
  <a href="scanner.html" class="nav-link"><i class="fas fa-qrcode"></i> Scan ID</a>
  <a href="regions.html" class="nav-link"><i class="fas fa-id-card"></i> Regions</a>
  <a href="scan-logs.html" class="nav-link"><i class="fas fa-history"></i> Activity Logs</a>
  <a href="admin.html" class="nav-link"><i class="fas fa-user-shield"></i> Admin Panel</a>
  <a href="settings.html" class="nav-link"><i class="fas fa-cog"></i> Settings</a>
</aside>


<!-- MAIN -->
<main>

<div class="setting-group">
  <h3>General</h3>

  <div class="setting">
    <span>System Name</span>
    <input id="system_name">
  </div>

  <div class="setting">
    <span>Organization Name</span>
    <input id="org_name">
  </div>
</div>

<div class="setting-group">
  <h3>Scanner</h3>

  <div class="setting">
    <span>Enable Scan Sound</span>
    <div class="toggle" id="soundToggle"></div>
  </div>

  <div class="setting">
    <span>Auto Restart Scanner</span>
    <div class="toggle" id="autoToggle"></div>
  </div>
</div>

<button class="save-btn" onclick="saveSettings()">
  <i class="fas fa-save"></i> Save Settings
</button>

</main>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const client = window.supabase.createClient(
  "https://pqrsljahrnjgkadflbmr.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBxcnNsamFocm5qZ2thZGZsYm1yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA1NTg0NTYsImV4cCI6MjA4NjEzNDQ1Nn0.egED0C2iRp6j3Xp4ldgrdI0GBep2J7VUR52rBbzsVdo"
);
  /* ACTIVE LINK */
document.querySelectorAll(".nav-link").forEach(l=>{
  if(l.getAttribute("href")==="settings.html") l.classList.add("active");
});

/* TOGGLE */
function toggle(el){
  el.classList.toggle("active");
}
soundToggle.onclick=()=>toggle(soundToggle);
autoToggle.onclick=()=>toggle(autoToggle);

/* LOAD SETTINGS */
async function loadSettings(){
  const { data } = await client
    .from("settings")
    .select("*")
    .eq("id",1)
    .single();

  if(!data) return;

  system_name.value=data.system_name||"";
  org_name.value=data.org_name||"";
  if(data.scan_sound) soundToggle.classList.add("active");
  if(data.auto_restart) autoToggle.classList.add("active");
}

/* SAVE SETTINGS */
async function saveSettings(){
  await client.from("settings").upsert({
    id:1,
    system_name: system_name.value,
    org_name: org_name.value,
    scan_sound: soundToggle.classList.contains("active"),
    auto_restart: autoToggle.classList.contains("active")
  });

  alert("Settings saved");
}

/* INIT */
loadSettings();
</script>

</body>
</html>
