<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Umoomi Members</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f9;
      padding: 20px;
    }
    h1 {
      margin-bottom: 10px;
    }
    .status {
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 15px;
      font-weight: bold;
    }
    .loading {
      background: #d1ecf1;
      color: #0c5460;
    }
    .success {
      background: #d4edda;
      color: #155724;
    }
    .error {
      background: #f8d7da;
      color: #721c24;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
    }
    th, td {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }
    th {
      background: #2c3e50;
      color: #fff;
    }
  </style>
</head>

<body>

<h1>üõ°Ô∏è Umoomi Members</h1>

<div id="status" class="status loading">Loading members...</div>

<table>
  <thead>
    <tr>
      <th>Member ID</th>
      <th>Full Name</th>
      <th>Position</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <tr>
      <td colspan="4">Loading...</td>
    </tr>
  </tbody>
</table>

<!-- SUPABASE CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
/* ===========================
   SUPABASE CONFIG
=========================== */
const SUPABASE_URL = "https://pqrsljahrnjgkadflbmr.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBxcnNsamFocm5qZ2thZGZsYm1yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA1NTg0NTYsImV4cCI6MjA4NjEzNDQ1Nn0.egED0C2iRp6j3Xp4ldgrdI0GBep2J7VUR52rBbzsVdo";

const supabase = window.supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

console.log("Supabase client initialized");

/* ===========================
   LOAD MEMBERS
=========================== */
async function loadMembers() {
  const statusEl = document.getElementById('status');
  const tableBody = document.getElementById('tableBody');

  try {
    const { data, error } = await supabase
      .from('umoomi_members')
      .select('*');

    if (error) throw error;

    if (!data || data.length === 0) {
      statusEl.className = "status success";
      statusEl.textContent = "No members found";
      tableBody.innerHTML = `
        <tr>
          <td colspan="4">No data</td>
        </tr>`;
      return;
    }

    tableBody.innerHTML = "";

    data.forEach(member => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${member.member_id || ''}</td>
        <td>${member.full_name || ''}</td>
        <td>${member.position || ''}</td>
        <td>${member.status || ''}</td>
      `;
      tableBody.appendChild(row);
    });

    statusEl.className = "status success";
    statusEl.textContent = `Loaded ${data.length} members`;

  } catch (err) {
    console.error(err);
    statusEl.className = "status error";
    statusEl.textContent = err.message;

    tableBody.innerHTML = `
      <tr>
        <td colspan="4">Failed to load data</td>
      </tr>`;
  }
}

/* ===========================
   INIT
=========================== */
document.addEventListener('DOMContentLoaded', () => {
  loadMembers();
});
</script>

</body>
</html>
